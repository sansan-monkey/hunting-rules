title: Rename_lolbins
id: 55070951-f145-428a-9f3b-6efd6b16720b
status: stable
description: detects  when a attacker  trying renamed, copied lolbins for purposes suspicious
author: 'sansan'
references: 
    - https://twitter.com/Max_Mal_/status/1417002625313222658
    - https://lolbas-project.github.io/#
tags:
    - attack.defense_evasion
    - attack.t1036.003
logsource:
    category: process_creation
    product: windows
detection:
    selection1:
       CommandLine|contains:
         - 'copy'
         - 'move'
    selection2:
        CommandLine|contains:
         - 'AppInstaller.exe'
         - 'Aspnet_Compiler.exe'
         - 'At.exe'
         - 'Atbroker.exe'
         - 'Bash.exe'
         - 'Bitsadmin.exe'
         - 'CertOC.exe'
         - 'CertReq.exe'
         - 'Certutil.exe'
         - 'Cmdkey.exe'
         - 'cmdl32.exe'
         - 'Cmstp.exe'
         - 'ConfigSecurityPolicy.exe'
         - 'Conhost.exe'
         - 'Control.exe'
         - 'Csc.exe'
         - 'Cscript.exe'
         - 'CustomShellHost.exe'
         - 'DataSvcUtil.exe'
         - 'Desktopimgdownldr.exe'
         - 'DeviceCredentialDeployment.exe'    
         - 'Dfsvc.exe'
         - 'Diantz.exe'
         - 'Diskshadow.exe'
         - 'Dnscmd.exe'
         - 'Esentutl.exe'
         - 'Eventvwr.exe'
         - 'Expand.exe'
         - 'Explorer.exe'
         - 'Extexport.exe'
         - 'Extrac32.exe'
         - 'Findstr.exe'
         - 'Finger.exe'
         - 'fltMC.exe'
         - 'Forfiles.exe'
         - 'Ftp.exe'
         - 'GfxDownloadWrapper.exe'
         - 'Gpscript.exe'
         - 'Hh.exe'
         - 'IMEWDBLD.exe'
         - 'Ie4uinit.exe'
         - 'Ieexec.exe'
         - 'Ilasm.exe'
         - 'Infdefaultinstall.exe'
         - 'Installutil.exe'
         - 'Jsc.exe'
         - 'Ldifde.exe'
         - 'Makecab.exe'
         - 'Makecab.exe'
         - 'Microsoft.Workflow.Compiler.exe'
         - 'Mmc.exe'
         - 'MpCmdRun.exe'
         - 'Msbuild.exe'
         - 'Msconfig.exe'
         - 'Msdt.exe'
         - 'Mshta.exe'
         - 'Msiexec.exe'
         - 'Netsh.exe'
         - 'Odbcconf.exe'
         - 'OfflineScannerShell.exe'
         - 'OneDriveStandaloneUpdater.exe'
         - 'Pcalua.exe'
         - 'Pcwrun.exe'
         - 'Pktmon.exe'
         - 'Pnputil.exe'
         - 'Presentationhost.exe'
         - 'Print.exe'
         - 'PrintBrm.exe'
         - Psr.exe
         - Rasautou.exe
         - rdrleakdiag.exe
         - Reg.exe
         - Regasm.exe
         - Regedit.exe
         - Regini.exe
         - Register-cimprovider.exe
         - Regsvcs.exe
         - Regsvr32.exe
         - Replace.exe
         - Rpcping.exe
         - Rundll32.exe
         - Runonce.exe
         - Runscripthelper.exe
         - Sc.exe
         - Schtasks.exe
         - Scriptrunner.exe
         - SettingSyncHost.exe
         - ssh.exe
         - Stordiag.exe
         - SyncAppvPublishingServer.exe
         - Ttdinject.exe
         - Tttracer.exe
         - Unregmp2.exe
         - vbc.exe
         - Verclsid.exe
         - Wab.exe
         - winget.exe
         - Wlrmdr.exe
         - Wmic.exe
         - WorkFolders.exe
         - Wscript.exe
         - Wsreset.exe
         - wuauclt.exe
         - Xwizard.exe
         - fsutil.exe
         - Advpack.dll
         - Desk.cpl
         - Dfshim.dll        
         - Ieadvpack.dll
         - Ieframe.dll
         - Mshtml.dll
         - Pcwutl.dll
         - Setupapi.dll
         - Shdocvw.dll
         - Shell32.dll
         - Syssetup.dll
         - Url.dll
         - Zipfldr.dll
         - Comsvcs.dll
         - AccCheckConsole.exe
         - adplus.exe
         - AgentExecutor.exe
         - Appvlp.exe
         - Bginfo.exe
         - Cdb.exe
         - coregen.exe
         - Createdump.exe
         - csi.exe
         - DefaultPack.EXE
         - Devtoolslauncher.exe
         - dnx.exe
         - Dotnet.exe
         - Dump64.exe
         - Dxcap.exe
         - Excel.exe
         - Fsi.exe
         - FsiAnyCpu.exe
         - Mftrace.exe
         - Msdeploy.exe
         - MsoHtmEd.exe
         - Mspub.exe
         - msxsl.exe
         - ntdsutil.exe
         - Powerpnt.exe
         - Procdump.exe
         - ProtocolHandler.exe
         - rcsi.exe
         - Remote.exe
         - Sqldumper.exe
         - Sqlps.exe
         - SQLToolsPS.exe
         - Squirrel.exe
         - te.exe
         - Tracker.exe
         - Update.exe
         - VSIISExeLauncher.exe
         - VisualUiaVerifyNative.exe
         - vsjitdebugger.exe
         - Wfc.exe
         - Winword.exe
         - Wsl.exe
         - CL_LoadAssembly.ps1
         - CL_Mutexverifiers.ps1
         - CL_Invocation.ps1
         - Manage-bde.wsf
         - Pubprn.vbs
         - Syncappvpublishingserver.vbs
         - UtilityFunctions.ps1
         - winrm.vbs
         - Pester.bat
    selection3:
        CommandLine|contains:
         - 'copy*cmd.exe'
         - 'move*cmd.exe'
    filter:
        CommandLine|contains:
         - 'remove'
    condition: (selection1 AND selection2) OR selection3 AND NOT filter
falsepositives:
    - Unknow
level: high
